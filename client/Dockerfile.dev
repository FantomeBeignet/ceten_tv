### Build Step
FROM node:19-alpine as build

ENV NODE_ENV development

ARG GOOGLE_CLIENT_ID
ARG GOOGLE_CLIENT_SECRET
ARG AUTH_SECRET
ARG NEXTAUTH_URL
ARG USER_WHITELIST

ENV GOOGLE_CLIENT_ID=${GOOGLE_CLIENT_ID}
ENV GOOGLE_CLIENT_SECRET=${GOOGLE_CLIENT_SECRET}
ENV AUTH_SECRET=${AUTH_SECRET}
ENV NEXTAUTH_URL=${NEXTAUTH_URL}
ENV USER_WHITELIST=${USER_WHITELIST}
ENV AUTH_TRUST_HOST true


WORKDIR /app

COPY package*.json ./

RUN npm install